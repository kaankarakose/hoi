<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Loader Visualization</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center mb-4">Data Loader Visualization</h1>
        
        <div class="control-panel">
            <div class="row">
                <div class="col-md-2">
                    <div class="form-group">
                        <label for="camera-select">Camera View:</label>
                        <select id="camera-select" class="form-control auto-update">
                            <option value="cam_top">Top Camera</option>
                            <option value="cam_side_l">Left Side Camera</option>
                            <option value="cam_side_r">Right Side Camera</option>
                        </select>
                    </div>
                    <small id="valid-frames-count" class="text-info mt-1">
                        Left: {{ valid_frames.get("cam_top", {}).get("left", [])|length }} frames / 
                        Right: {{ valid_frames.get("cam_top", {}).get("right", [])|length }} frames
                    </small>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="frame-select">Frame Index:</label>
                        <div class="d-flex align-items-center">
                            <input type="range" id="frame-select" class="form-range flex-grow-1 auto-update" 
                                min="{{ valid_frames.get('cam_top', {}).get('left', [])[0] if valid_frames.get('cam_top', {}).get('left', []) else 0 }}" 
                                max="{{ valid_frames.get('cam_top', {}).get('left', [])[-1] if valid_frames.get('cam_top', {}).get('left', []) else 100 }}" 
                                value="{{ default_frame }}" 
                                step="1">
                            <span id="frame-value" class="ms-2">{{ default_frame }}</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <label for="frame-type-select">Frame Type (CNOS):</label>
                        <select id="frame-type-select" class="form-control auto-update">
                            <option value="L_frames">Left Hand (L_frames)</option>
                            <option value="R_frames">Right Hand (R_frames)</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="object-select">Object for Flow Analysis:</label>
                        <select id="object-select" class="form-control auto-update">
                            <option value="">-- All Objects --</option>
                            <option value="AMF1">AMF1</option>
                            <option value="AMF2">AMF2</option>
                            <option value="AMF3">AMF3</option>
                            <option value="BOX">BOX</option>
                            <option value="CUP">CUP</option>
                            <option value="DINOSAUR">DINOSAUR</option>
                            <option value="FIRETRUCK">FIRETRUCK</option>
                            <option value="HAIRBRUSH">HAIRBRUSH</option>
                            <option value="PINCER">PINCER</option>
                            <option value="WRENCH">WRENCH</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <label for="flow-feature-type">Flow Feature Type:</label>
                        <select id="flow-feature-type" class="form-control auto-update">
                            <option value="all">All Features</option>
                            <option value="direction">Direction</option>
                            <option value="brightness">Brightness</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <button id="update-btn" class="btn btn-primary mt-4">Update Visualizations</button>
                </div>
            </div>
            <!-- Auto-update toggle (optional enhancement) -->
            <div class="form-check mt-2">
                <input class="form-check-input" type="checkbox" id="auto-update-toggle">
                <label class="form-check-label" for="auto-update-toggle">
                    Auto-update when changing parameters
                </label>
            </div>
        </div>
        
        <div class="row">
            <!-- Flow Visualization -->
            <div class="col-md-6">
                <div class="visualization-container">
                    <h3>Optical Flow Data</h3>
                    <div id="flow-loading" class="loading d-none">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                    <div id="flow-error" class="error-message d-none"></div>
                    <img id="flow-image" class="visualization-image" src="" alt="Flow Visualization">
                    <div id="flow-data" class="data-info">
                        <p>Select parameters and click 'Update Visualizations' to load data.</p>
                    </div>
                </div>
            </div>
            
            <!-- CNOS Visualization -->
            <div class="col-md-6">
                <div class="visualization-container">
                    <h3>CNOS Data (Object Segmentation)</h3>
                    <div id="cnos-loading" class="loading d-none">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                    <div id="cnos-error" class="error-message d-none"></div>
                    <img id="cnos-image" class="visualization-image" src="" alt="CNOS Visualization">
                    <div id="cnos-data" class="data-info">
                        <p>Select parameters and click 'Update Visualizations' to load data.</p>
                    </div>
                </div>
            </div>
            
            <!-- HAMER Visualization -->
            <div class="col-md-6">
                <div class="visualization-container">
                    <h3>HAMER Data (Hand Mesh)</h3>
                    <div id="hamer-loading" class="loading d-none">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                    <div id="hamer-error" class="error-message d-none"></div>
                    <img id="hamer-image" class="visualization-image" src="" alt="HAMER Visualization">
                    <div id="hamer-data" class="data-info">
                        <p>Select parameters and click 'Update Visualizations' to load data.</p>
                    </div>
                </div>
            </div>
            
            <!-- Combined Visualization -->
            <div class="col-md-6">
                <div class="visualization-container">
                    <h3>Combined Visualization</h3>
                    <div id="combined-loading" class="loading d-none">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                    <div id="combined-error" class="error-message d-none"></div>
                    <img id="combined-image" class="visualization-image" src="" alt="Combined Visualization">
                    <div id="combined-data" class="data-info">
                        <p>Select parameters and click 'Update Visualizations' to load data.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Application JS -->
    <script src="{{ url_for('static', filename='js/api-service.js') }}"></script>
    <script src="{{ url_for('static', filename='js/visualization-ui.js') }}"></script>
</body>
</html>
